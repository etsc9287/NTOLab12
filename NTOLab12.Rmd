---
title: "NTOLab12"
author: "Ethan, Anderson, David, Ryan, Arie"
date: "4/12/2019"
output: html_document
---
```{r,echo = FALSE, message=FALSE}
>>>>>>> master
library(tidyverse)
library(gapminder)
gapminder <- gapminder
```
<<<<<<< HEAD

```{r}
=======
*****
#### Overall Questions/Conclusion
*****
* Question(Two-Sample Permutation test): From 1957-2007, how does the mean difference of GDP change over time between the United States and China, India, Japan, South Korea, and Indonesia? This question is important and interesting because over time it will show if the GDP per capita of the asain countries catch up to the GDP per capita of the United States.

* Question(Correlation Permutation test): What is the correlation bewteen GDP per capita and life expectancy? This question is important and interesting because 

*****
#### Two-Sample Permuatation test
*****
```{r, echo=FALSE, warning=FALSE}
perm_mean <- function(perms, values, n1)
{
## step one
  result <- vector("numeric", perms)
  
  # Loop throught number of permutations
  for (i in 1:perms)
  {
    x <- sample(1:length(values), n1)
  
  group1 <- values[x]
  group2 <- values[-x]

  diff <- mean(group1)-mean(group2)
  result[i] <- diff
    # Step 4:

  }
  # Step 5:
 result <- as.tibble(result)
 print(result)
  }

test1 <- perm_mean(1000,c(1:100),50)

ggplot(data = test1, mapping = aes(x= value))+
  geom_density()

```
<<<<<<< HEAD

```{r}
=======
*****
#### Correlation Permutation Test
*****
```{r, echo=FALSE}
>>>>>>> master
perm_cor <- function(perms,x,y){
  result <- vector("numeric",perms)

for( i in c(1:perms))
{
  y <- sample(y,length(y))
  c <- cor(x,y)
  result[i] <- c
}
result <- as.tibble(result)
print(result)
}
perm_cor(100,c(1:10),c(1:10))

```

```{r, echo = FALSE}

countries <- gapminder::gapminder_unfiltered

#Mean Difference Permutation

asiaGDP <- countries %>%
  filter(continent == "Asia") %>%
  filter(country == "China" | country == "India" | country == "South Korea" | country == "Japan" | country == "Indonesia") %>%
  select(country, year, gdpPercap) %>%
  group_by(year) %>%
  summarise(asia_avg_gdp = mean(gdpPercap))

usaGDP <- countries %>%
  filter(country == "United States") %>%
  mutate(usa_gdp = gdpPercap) %>%
  select(year, usa_gdp) %>%
  filter(str_detect(year, "2$") | str_detect(year, "7$"))

GDPdifference <- inner_join(asiaGDP, usaGDP, by = "year") %>%
  mutate(gdp_difference = usa_gdp - asia_avg_gdp)

ggplot(data = GDPdifference) +
  geom_line(mapping = aes(x = year, y = gdp_difference)) +
  xlab("Year") +
  ylab("GDP per Capita Difference") +
  ggtitle("GDP per Capita Difference between USA and Asian Countries Over Time", subtitle = "Asian Countries Include: China, India, Japan, Indonesia, South Korea (top 5 Asia GDP's)")

#Correlation Permutation: GDP per Capita vs. Life Expectancy

country_stats <- countries %>%
  group_by(country) %>%
  summarise(avg_lifeExp = mean(lifeExp), avg_GDP = mean(gdpPercap))

continents <- countries %>%
  select(country, continent) %>%
  distinct()
population <- countries %>%
  select(country, pop) %>%
  group_by(country) %>%
  summarise(avg_pop = mean(pop))

country_stats2 <- left_join(country_stats, continents, by = "country") %>%
  left_join(population, by = "country")

ggplot(data = country_stats2) +
  geom_point(mapping = aes(x = avg_GDP, y = avg_lifeExp, color = continent, size = avg_pop)) +
  labs(size = "Avg. Population", color = "Continent") +
  xlab("Average GDP per Capita") +
  ylab("Average Life Expectancy") +
  ggtitle("Avg GDP per Capita vs. Avg Life Expectancy for Every Country (1952-2007)")
```

*****
#### Who did what
*****

* David:

* Ethan:

* Ryan:

* Anderson:

* Arie:
